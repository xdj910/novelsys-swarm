# NOVELSYS-SWARM 2.5 å®Œæ•´ç³»ç»Ÿæ¶æ„ä¸æµç¨‹æ–‡æ¡£

> **ç»ˆæå°è¯´ç”Ÿæˆç³»ç»Ÿ - ä»æ¦‚å¿µåˆ°æˆç¨¿çš„å®Œæ•´è§£å†³æ–¹æ¡ˆ**  
> Version: 2.5.0 | Updated: 2025-01-30  
> Status: Production Ready | 100% å®ç°

## ç›®å½•

1. [ç³»ç»Ÿæ¦‚è¿°](#1-ç³»ç»Ÿæ¦‚è¿°)
2. [æ ¸å¿ƒæ¶æ„](#2-æ ¸å¿ƒæ¶æ„)
3. [æŠ€æœ¯æ ˆ](#3-æŠ€æœ¯æ ˆ)
4. [æ¨¡å—è¯¦è§£](#4-æ¨¡å—è¯¦è§£)
5. [å·¥ä½œæµç¨‹](#5-å·¥ä½œæµç¨‹)
6. [æ•°æ®æµ](#6-æ•°æ®æµ)
7. [å‘½ä»¤ç³»ç»Ÿ](#7-å‘½ä»¤ç³»ç»Ÿ)
8. [Agentä½“ç³»](#8-agentä½“ç³»)
9. [è´¨é‡æ§åˆ¶](#9-è´¨é‡æ§åˆ¶)
10. [æ€§èƒ½ä¼˜åŒ–](#10-æ€§èƒ½ä¼˜åŒ–)
11. [éƒ¨ç½²æŒ‡å—](#11-éƒ¨ç½²æŒ‡å—)
12. [APIå‚è€ƒ](#12-apiå‚è€ƒ)

---

## 1. ç³»ç»Ÿæ¦‚è¿°

### 1.1 ç³»ç»Ÿå®šä½

NOVELSYS-SWARM 2.5 æ˜¯ä¸€ä¸ª**AIé©±åŠ¨çš„ä¸“ä¸šå°è¯´åˆ›ä½œç³»ç»Ÿ**ï¼Œé€šè¿‡8-Streamå¤šç»´åº¦ååŒæ¶æ„å’Œæ™ºèƒ½Agentç¼–æ’ï¼Œå®ç°98åˆ†è´¨é‡ç›®æ ‡çš„å°è¯´è‡ªåŠ¨ç”Ÿæˆã€‚

### 1.2 æ ¸å¿ƒä»·å€¼

| ç»´åº¦ | ä»·å€¼ç‚¹ | é‡åŒ–æŒ‡æ ‡ |
|-----|--------|---------|
| **è´¨é‡** | 8-Streamå¤šç»´åº¦å¤„ç† | 98åˆ†ç›®æ ‡è´¨é‡ |
| **æ•ˆç‡** | å¹¶è¡Œæ‰§è¡Œæ¶æ„ | 3xé€Ÿåº¦æå‡ |
| **æ™ºèƒ½** | åŠ¨æ€Agentåˆ†é… | 10ç§ç« èŠ‚ç±»å‹è¯†åˆ« |
| **æŒä¹…** | GitHub+æœ¬åœ°åŒå­˜å‚¨ | 100%è·¨ä¼šè¯æ¢å¤ |
| **å¯æ§** | 5é˜¶æ®µè§„èŒƒæµç¨‹ | å®Œå…¨å¯è¿½æº¯ |

### 1.3 æŠ€æœ¯åˆ›æ–°

1. **Context Firewallæ¶æ„** - ä¸»çº¿ç¨‹tokenä½¿ç”¨å‡å°‘70%
2. **GitHub Issuesæ•°æ®åº“** - æ°¸ä¹…åŒ–ä¸Šä¸‹æ–‡å­˜å‚¨
3. **Parallel-Workeræ¨¡å¼** - çœŸæ­£çš„8-Streamå¹¶è¡Œ
4. **ä¾èµ–å›¾ç®¡ç†** - ä¼ç¬”å…¨ç”Ÿå‘½å‘¨æœŸè¿½è¸ª
5. **å¢é‡åŒæ­¥æœºåˆ¶** - 90%å¸¦å®½èŠ‚çœ

### 1.4 ç³»ç»Ÿè¾¹ç•Œ

**å¯ä»¥åš**ï¼š
- âœ… é•¿ç¯‡å°è¯´åˆ›ä½œï¼ˆ10ä¸‡å­—+ï¼‰
- âœ… å¤šçº¿ç¨‹æƒ…èŠ‚ç®¡ç†
- âœ… å¤æ‚äººç‰©å…³ç³»
- âœ… ä¼ç¬”é“ºè®¾ä¸å›æ”¶
- âœ… é£æ ¼ä¸€è‡´æ€§ä¿æŒ

**ä¸é€‚åˆ**ï¼š
- âŒ è¯—æ­Œåˆ›ä½œ
- âŒ å‰§æœ¬æ ¼å¼
- âŒ å­¦æœ¯è®ºæ–‡
- âŒ æ–°é—»æŠ¥é“

---

## 2. æ ¸å¿ƒæ¶æ„

### 2.1 ç³»ç»Ÿæ¶æ„å›¾

```
â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”
â”‚                     ç”¨æˆ·ç•Œé¢å±‚ (Claude Code)                 â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                        å‘½ä»¤è·¯ç”±å±‚                             â”‚
â”‚  /novel:init  /novel:bible-create  /novel:chapter-start     â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Context Firewall                        â”‚
â”‚              [ä¸»çº¿ç¨‹ä¿æŠ¤ - åªæ¥æ”¶50å­—æ‘˜è¦]                    â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                    å¹¶è¡Œåè°ƒå±‚ (Coordinator)                   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Stream 1  â”‚  â”‚Stream 2  â”‚  â”‚Stream 3  â”‚  â”‚Stream 4  â”‚   â”‚
â”‚  â”‚Character â”‚  â”‚Narrative â”‚  â”‚World     â”‚  â”‚Prose     â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”   â”‚
â”‚  â”‚Stream 5  â”‚  â”‚Stream 6  â”‚  â”‚Stream 7  â”‚  â”‚Stream 8  â”‚   â”‚
â”‚  â”‚Continuityâ”‚  â”‚Foreshadowâ”‚  â”‚Dialogue  â”‚  â”‚Emotion   â”‚   â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜   â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                      Agentæ‰§è¡Œå±‚                             â”‚
â”‚         25ä¸ªé¢„å®šä¹‰Agent + åŠ¨æ€ç‰¹åŒ–Agent (4-7ä¸ª)              â”‚
â”œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¤
â”‚                     æ•°æ®æŒä¹…åŒ–å±‚                             â”‚
â”‚  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”  â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”       â”‚
â”‚  â”‚GitHub Issuesâ”‚  â”‚Local Files  â”‚  â”‚Git Worktree â”‚       â”‚
â”‚  â”‚(æ°¸ä¹…å­˜å‚¨)    â”‚  â”‚(YAML/JSON)  â”‚  â”‚(å¹¶è¡Œåˆ†æ”¯)   â”‚       â”‚
â”‚  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜  â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜       â”‚
â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜
```

### 2.2 ç›®å½•ç»“æ„

```
NOVELSYS-SWARM/
â”œâ”€â”€ .claude/                      # Claudeç³»ç»Ÿæ–‡ä»¶
â”‚   â”œâ”€â”€ agents/                   # Agentå®šä¹‰ï¼ˆ29ä¸ªï¼‰
â”‚   â”‚   â”œâ”€â”€ novel-parallel-coordinator.md  # å¹¶è¡Œåè°ƒå™¨
â”‚   â”‚   â”œâ”€â”€ character-psychology-specialist.md
â”‚   â”‚   â””â”€â”€ [å…¶ä»–27ä¸ªAgentå®šä¹‰]
â”‚   â”œâ”€â”€ commands/                 # å‘½ä»¤å®šä¹‰
â”‚   â”‚   â””â”€â”€ novel/               # å°è¯´å‘½ä»¤ï¼ˆ15ä¸ªï¼‰
â”‚   â”‚       â”œâ”€â”€ init.md
â”‚   â”‚       â”œâ”€â”€ bible-create.md
â”‚   â”‚       â”œâ”€â”€ chapter-start.md
â”‚   â”‚       â”œâ”€â”€ parallel-chapter.md
â”‚   â”‚       â””â”€â”€ [å…¶ä»–å‘½ä»¤]
â”‚   â”œâ”€â”€ context/                 # ä¸Šä¸‹æ–‡æ¨¡æ¿
â”‚   â”œâ”€â”€ docs/                    # æ–‡æ¡£
â”‚   â””â”€â”€ rules/                   # ç³»ç»Ÿè§„åˆ™
â”‚
â”œâ”€â”€ src/                         # æºä»£ç 
â”‚   â”œâ”€â”€ core/                    # æ ¸å¿ƒæ¨¡å—ï¼ˆæ–°å¢9ä¸ªï¼‰
â”‚   â”‚   â”œâ”€â”€ context_firewall.py          # Contexté˜²æŠ¤ âœ¨
â”‚   â”‚   â”œâ”€â”€ github_integration.py        # GitHubé›†æˆ âœ¨
â”‚   â”‚   â”œâ”€â”€ parallel_coordinator.py      # å¹¶è¡Œåè°ƒå™¨ âœ¨
â”‚   â”‚   â”œâ”€â”€ agent_type_mapper.py         # åŠ¨æ€Agent âœ¨
â”‚   â”‚   â”œâ”€â”€ execution_status.py          # çŠ¶æ€è¿½è¸ª âœ¨
â”‚   â”‚   â”œâ”€â”€ git_worktree_manager.py      # Worktreeç®¡ç† âœ¨
â”‚   â”‚   â”œâ”€â”€ five_stage_workflow.py       # 5é˜¶æ®µæµç¨‹ âœ¨
â”‚   â”‚   â”œâ”€â”€ dependency_manager.py        # ä¾èµ–ç®¡ç† âœ¨
â”‚   â”‚   â”œâ”€â”€ incremental_sync.py          # å¢é‡åŒæ­¥ âœ¨
â”‚   â”‚   â”œâ”€â”€ ultimate_stream_integrator.py
â”‚   â”‚   â”œâ”€â”€ command_executor.py
â”‚   â”‚   â”œâ”€â”€ agent_executor.py
â”‚   â”‚   â””â”€â”€ data_persistence.py
â”‚   â”œâ”€â”€ streams/                 # 8-Streamå®ç°
â”‚   â”‚   â”œâ”€â”€ core/               # 4ä¸ªæ ¸å¿ƒStream
â”‚   â”‚   â””â”€â”€ enhanced/           # 4ä¸ªå¢å¼ºStream
â”‚   â””â”€â”€ utils/                  # å·¥å…·å‡½æ•°
â”‚
â”œâ”€â”€ data/                        # æ•°æ®å­˜å‚¨
â”‚   â”œâ”€â”€ bibles/                 # Bibleå­˜å‚¨
â”‚   â”œâ”€â”€ chapters/               # ç« èŠ‚å†…å®¹
â”‚   â”œâ”€â”€ context/                # å…±äº«ä¸Šä¸‹æ–‡
â”‚   â”œâ”€â”€ workflow/               # 5é˜¶æ®µå·¥ä½œæµ
â”‚   â”œâ”€â”€ dependencies/           # ä¾èµ–å…³ç³»
â”‚   â”œâ”€â”€ sync_cache/             # åŒæ­¥ç¼“å­˜
â”‚   â””â”€â”€ status/                 # æ‰§è¡ŒçŠ¶æ€
â”‚
â””â”€â”€ tests/                       # æµ‹è¯•æ–‡ä»¶
```

---

## 3. æŠ€æœ¯æ ˆ

### 3.1 è¿è¡Œç¯å¢ƒ

| ç»„ä»¶ | ç‰ˆæœ¬/è¦æ±‚ | è¯´æ˜ |
|-----|----------|------|
| **Claude Code** | Latest | æ‰§è¡Œç¯å¢ƒ |
| **Python** | 3.8+ | æ ¸å¿ƒé€»è¾‘ |
| **Git** | 2.28+ | ç‰ˆæœ¬æ§åˆ¶ |
| **GitHub CLI** | 2.0+ | Issueç®¡ç† |
| **æ–‡ä»¶ç³»ç»Ÿ** | Any | æœ¬åœ°å­˜å‚¨ |

### 3.2 æ ¸å¿ƒä¾èµ–

**Requirements specification:**
1. Install networkx version 2.6 or higher for dependency graph management
2. Install pyyaml version 5.4 or higher for YAML file processing
3. Install aiofiles version 0.8 or higher for asynchronous file input/output operations
4. Include asyncio module for parallel execution capabilities
5. Include difflib module for content difference calculation
6. Include hashlib module for content hash generation

### 3.3 Claudeç‰¹å®šå·¥å…·

```yaml
å¿…éœ€å·¥å…·:
  - Task: SubAgentè°ƒç”¨
  - Read/Write: æ–‡ä»¶æ“ä½œ
  - Bash: ç³»ç»Ÿå‘½ä»¤
  - WebFetch: èµ„æ–™è·å–
  - TodoWrite: ä»»åŠ¡ç®¡ç†
```

---

## 4. æ¨¡å—è¯¦è§£

### 4.1 Context Firewall (context_firewall.py)

**åŠŸèƒ½**ï¼šä¿æŠ¤ä¸»çº¿ç¨‹ä¸è¢«ç»†èŠ‚æ±¡æŸ“

**AgentResponse data structure specialist:**
1. Create summary field containing 50-character summary for main thread
2. Set status field indicating execution state (success/partial/failed)
3. Populate decisions list with key strategic decisions made
4. Add next_steps list with recommended follow-up actions
5. Store detailed content in _details field (internal use only, not returned to main thread)

**ä½¿ç”¨ç¤ºä¾‹**ï¼š
**Context firewall protected agent execution:**
1. Apply context firewall decorator with maximum summary length of 50 characters
2. Execute agent asynchronously
3. Generate detailed content (approximately 2000 characters)
4. Create AgentResponse with concise summary
5. Store complete details internally without returning to main thread
6. Return summary: "å®Œæˆè§’è‰²å¿ƒç†åˆ†æï¼Œè¯†åˆ«3ä¸ªåŠ¨æœº"

### 4.2 GitHub Integration (github_integration.py)

**åŠŸèƒ½**ï¼šä½¿ç”¨GitHub Issuesä½œä¸ºæŒä¹…åŒ–æ•°æ®åº“

**GitHub Integration specialist:**
1. **Create novel repository:** Take project name as input, return success status and repository URL
2. **Create GitHub issue:** Accept title, body content, and label list, return success status and issue number
3. **Sync chapter to issue:** Take chapter number and chapter data dictionary, update corresponding GitHub issue, return sync status
4. **Load Bible from issue:** Retrieve Bible configuration from GitHub issues, return Bible data or None if not found

**Issueç»“æ„**ï¼š
```
Novel Project Repo
â”œâ”€â”€ Issue #1: Bibleå®šä¹‰ï¼ˆEpicï¼‰
â”‚   â”œâ”€â”€ Comment 1: Bibleæ›´æ–°
â”‚   â””â”€â”€ Comment 2: è®¾å®šè¡¥å……
â”œâ”€â”€ Issue #2: ç¬¬1ç« ï¼ˆTaskï¼‰
â”‚   â”œâ”€â”€ Comment 1: Streamåˆ†æ
â”‚   â”œâ”€â”€ Comment 2: Agent-1è¿›åº¦
â”‚   â””â”€â”€ Comment 3: è´¨é‡æŠ¥å‘Š
â””â”€â”€ Issue #3: ç¬¬2ç« ï¼ˆTaskï¼‰
```

### 4.3 Parallel Coordinator (parallel_coordinator.py)

**åŠŸèƒ½**ï¼šç®¡ç†8ä¸ªStreamçš„å¹¶è¡Œæ‰§è¡Œ

**Novel parallel coordinator specialist:**
1. **Analyze chapter requirements:** Take chapter number, outline, and Bible context as input
2. **Determine chapter type:** Analyze outline and Bible context to identify chapter characteristics
3. **Allocate specialized agents:** Use agent pool to assign appropriate agents based on chapter type
4. **Launch 8-Stream execution:** Create tasks for each of the eight core streams plus dynamic agents
5. **Execute streams in parallel:** Run all stream tasks concurrently using async execution
6. **Merge stream results:** Intelligently combine outputs from all streams into cohesive chapter content
7. Return merged chapter data dictionary

### 4.4 Agent Type Mapper (agent_type_mapper.py)

**åŠŸèƒ½**ï¼šæ ¹æ®ç« èŠ‚ç±»å‹åŠ¨æ€åˆ†é…Agent

**Agent type mapping specialist:**
1. **Define chapter type mappings:**
   â€¢ Action chapters: Assign action-choreographer and pacing-specialist
   â€¢ Romance chapters: Assign emotion-weaver and dialogue-master
   â€¢ Mystery chapters: Assign suspense-engineer and clue-tracker
   â€¢ Climax chapters: Assign climax-orchestrator and tension-maximizer

2. **Agent allocation process:**
   â€¢ Start with base 8-Stream agents (always required)
   â€¢ Identify chapter type from input
   â€¢ Add specialized agents based on chapter type
   â€¢ Return combined agent list (typically 8-15 agents total)

### 4.5 Execution Status Tracker (execution_status.py)

**åŠŸèƒ½**ï¼šå®æ—¶è¿½è¸ªæ‰§è¡Œè¿›åº¦

**Execution status tracker specialist:**
1. **Start chapter tracking:** Initialize tracking for specific chapter with total agent count
2. **Start agent tracking:** Begin monitoring individual agent with name and type
3. **Update agent progress:** Record progress percentage for specified agent
4. **Complete agent execution:** Mark agent as finished with quality score
5. **Generate status report:** Create comprehensive status summary for current execution state

**çŠ¶æ€æŠ¥å‘Šç¤ºä¾‹**ï¼š
```
## ğŸ“Š NOVELSYSæ‰§è¡ŒçŠ¶æ€

### ğŸ“– ç¬¬1ç« : è§‰é†’ä¹‹æ—¥
- æ•´ä½“è¿›åº¦: 75%
- AgentçŠ¶æ€: 6/8 å®Œæˆ

### ğŸ¤– Agentæ‰§è¡ŒçŠ¶æ€
âœ… Character Psychology: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100% - 95åˆ†
âœ… Narrative Structure: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ] 100% - 92åˆ†
â³ World Building: [â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ--------] 60%
```

### 4.6 Git Worktree Manager (git_worktree_manager.py)

**åŠŸèƒ½**ï¼šå¤šç« èŠ‚å¹¶è¡Œåˆ›ä½œ

**Git worktree manager specialist:**
1. **Create chapter worktree:** Establish isolated Git worktree for specific chapter, return success status and path
2. **Create parallel chapter worktrees:** Set up multiple worktrees for concurrent chapter development, return mapping of chapter numbers to paths
3. **Sync worktree to main branch:** Merge completed chapter worktree back to main branch, return sync success status

**Worktreeç»“æ„**ï¼š
```
novelsys-worktrees/
â”œâ”€â”€ chapter-1/    # ç‹¬ç«‹åˆ†æ”¯ chapter/1
â”œâ”€â”€ chapter-2/    # ç‹¬ç«‹åˆ†æ”¯ chapter/2
â””â”€â”€ chapter-3/    # ç‹¬ç«‹åˆ†æ”¯ chapter/3
```

### 4.7 Five Stage Workflow (five_stage_workflow.py)

**åŠŸèƒ½**ï¼š5é˜¶æ®µè§„èŒƒåŒ–æµç¨‹

**Five stage workflow specialist:**
1. **Stage 1 - Concept creation:** Generate concept from title, genre, themes, and target audience, return concept ID
2. **Stage 2 - Bible planning:** Create comprehensive Bible document from concept, return Bible ID
3. **Stage 3 - Chapter decomposition:** Break Bible into individual chapter outlines, return list of chapter IDs
4. **Stage 4 - Scene generation:** Generate detailed scenes for each chapter, return list of scene IDs
5. **Stage 5 - Manuscript polishing:** Compile and refine all scenes into final manuscript, return manuscript ID

**æµç¨‹è¿½æº¯**ï¼š
```
æ¦‚å¿µ(concept_001)
  â””â†’ Bible(bible_001)
      â””â†’ ç« èŠ‚1(chapter_001)
          â”œâ†’ åœºæ™¯1(scene_001)
          â”œâ†’ åœºæ™¯2(scene_002)
          â””â†’ åœºæ™¯3(scene_003)
              â””â†’ æˆç¨¿(manuscript_001) [è´¨é‡: 95åˆ†]
```

### 4.8 Dependency Manager (dependency_manager.py)

**åŠŸèƒ½**ï¼šç®¡ç†ç« èŠ‚é—´ä¾èµ–å…³ç³»

**Dependency manager specialist:**
1. **Add chapter dependency:** Create dependency relationship between source and target chapters with type and description, return dependency ID
2. **Add foreshadowing element:** Establish foreshadowing with setup chapter and planned payoff chapter, return foreshadowing ID
3. **Validate chapter readiness:** Check if chapter dependencies are satisfied, return readiness status and list of unmet dependencies
4. **Determine execution order:** Analyze chapter dependencies to create optimal execution sequence, return ordered chapter list

**ä¾èµ–ç±»å‹**ï¼š
- `FORESHADOWING` - ä¼ç¬”ä¾èµ–
- `PLOT` - æƒ…èŠ‚ä¾èµ–
- `CHARACTER` - è§’è‰²å‘å±•ä¾èµ–
- `TEMPORAL` - æ—¶é—´é¡ºåºä¾èµ–

**ä¾èµ–å›¾å¯è§†åŒ–**ï¼š
```mermaid
graph TD
    chapter_1 -->|ä¼ç¬”| chapter_5
    chapter_2 -->|è§’è‰²| chapter_4
    chapter_3 -->|æƒ…èŠ‚| chapter_6
```

### 4.9 Incremental Sync (incremental_sync.py)

**åŠŸèƒ½**ï¼šæ™ºèƒ½å¢é‡åŒæ­¥

**Incremental sync manager specialist:**
1. **Detect file changes:** Analyze file for modifications, return change status and change details
2. **Execute incremental sync:** Synchronize only changed portions between source and target, return sync status and sync record
3. **Optimize batch synchronization:** Group files for efficient batch processing, return optimized file batches

**åŒæ­¥ç­–ç•¥**ï¼š
- å°æ”¹åŠ¨(<10è¡Œ) â†’ `patch`æ¨¡å¼
- ä¸­æ”¹åŠ¨(<100è¡Œ) â†’ `incremental`æ¨¡å¼
- å¤§æ”¹åŠ¨(>100è¡Œ) â†’ `full`æ¨¡å¼

**æ€§èƒ½ä¼˜åŒ–**ï¼š
- å†…å®¹å“ˆå¸Œç¼“å­˜
- å·®å¼‚è®¡ç®—
- æ‰¹é‡ä¼˜åŒ–
- å¸¦å®½èŠ‚çœ90%

---

## 5. å·¥ä½œæµç¨‹

### 5.1 å®Œæ•´åˆ›ä½œæµç¨‹

```mermaid
graph TB
    A[ç”¨æˆ·è¾“å…¥å‘½ä»¤] -->|/novel:init| B[ç³»ç»Ÿåˆå§‹åŒ–]
    B --> C[æ¦‚å¿µæ„æ€]
    C -->|/novel:concept-new| D[åˆ›å»ºæ¦‚å¿µæ–‡æ¡£]
    D --> E[Bibleè§„åˆ’]
    E -->|/novel:bible-create| F[ç”ŸæˆBible]
    F --> G[ç« èŠ‚åˆ†è§£]
    G -->|/novel:chapter-decompose| H[åˆ›å»ºç« èŠ‚å¤§çº²]
    H --> I[åœºæ™¯ç”Ÿæˆ]
    I -->|/novel:parallel-chapter| J[8-Streamå¹¶è¡Œå¤„ç†]
    J --> K[è´¨é‡è¯„ä¼°]
    K -->|<90åˆ†| L[è¿­ä»£ä¼˜åŒ–]
    L --> J
    K -->|â‰¥90åˆ†| M[æˆç¨¿æ¶¦è‰²]
    M --> N[åŒæ­¥GitHub]
    N --> O[å¯¼å‡ºä½œå“]
```

### 5.2 ç« èŠ‚ç”Ÿæˆè¯¦ç»†æµç¨‹

#### Step 1: å‘½ä»¤æ¥æ”¶
```bash
ç”¨æˆ·è¾“å…¥: /novel:chapter-start 1
```

#### Step 2: å‡†å¤‡é˜¶æ®µ
**Chapter preparation process:**
1. **Load Bible configuration:** Read the complete Bible document from file system
2. **Retrieve chapter outline:** Extract outline for specified chapter number (chapter 1)
3. **Analyze chapter characteristics:** Determine chapter type based on outline content (example result: "action")
4. **Validate dependencies:** Check if all required dependencies are met for this chapter, identify any unmet dependencies

#### Step 3: Agentåˆ†é…
**Agent allocation strategy:**
1. **Assign core 8-Stream agents:**
   â€¢ character-psychology-specialist
   â€¢ narrative-structure-specialist
   â€¢ world-building-specialist
   â€¢ prose-craft-specialist
   â€¢ continuity-guard-specialist
   â€¢ foreshadowing-specialist
   â€¢ dialogue-master-specialist
   â€¢ emotion-weaver-specialist

2. **Add specialized agents based on chapter type:**
   â€¢ For action chapters: Add action-choreographer and pacing-specialist
   â€¢ Total agents assigned: 10 (8 core + 2 specialized)

#### Step 4: å¹¶è¡Œæ‰§è¡Œ
**Parallel execution workflow:**
1. **Create Git worktree:** Establish isolated working directory for chapter 1
2. **Initialize parallel coordinator:** Set up coordinator with GitHub integration
3. **Execute multi-stream processing:** Run all assigned agents (8-Stream + specialized) concurrently with chapter parameters
4. **Apply Context Firewall filtering:**
   â€¢ Each agent returns 50-character summary to main thread
   â€¢ Store complete detailed content in data/streams/ch1/{stream_name}.md files

#### Step 5: ç»“æœåˆå¹¶
**Results processing workflow:**
1. **Collect stream results:** Gather summaries and quality scores from all streams
   â€¢ Character Psychology: "å®Œæˆ3ä¸ªè§’è‰²åˆ†æ" (95 points)
   â€¢ Narrative Structure: "ä¸‰å¹•å¼ç»“æ„å»ºç«‹" (92 points)
   â€¢ Plus results from remaining 6 streams

2. **Detect and resolve conflicts:** Identify conflicts between stream outputs and resolve using priority system
   â€¢ Priority order: Continuity > Character > Plot > Prose

3. **Intelligent merging:** Combine all stream outputs into cohesive chapter content

#### Step 6: è´¨é‡æ§åˆ¶
**Quality control process:**
1. **Assess content quality:** Evaluate merged content across dimensions:
   â€¢ Character depth, plot coherence, prose quality, setting consistency
   â€¢ Emotional resonance, dialogue naturalness, foreshadowing completeness

2. **Apply three-round iteration system:**
   â€¢ Round 1 (if score < 85): Fix basic issues and structural problems
   â€¢ Round 2 (if score < 92): Perform deep optimization and enhancement
   â€¢ Round 3 (if score < 98): Apply final polish and refinement

#### Step 7: æŒä¹…åŒ–
**Persistence and synchronization:**
1. **Save to local storage:** Write completed chapter content to local file system
2. **Synchronize to GitHub Issues:** Update corresponding GitHub issue with:
   â€¢ Final chapter content
   â€¢ Quality assessment score
   â€¢ Individual stream results
   â€¢ Total execution time
3. **Enable incremental sync:** Set up automated synchronization for future updates between local files and GitHub issues

### 5.3 ä¼ç¬”ç®¡ç†æµç¨‹

**Foreshadowing management process:**
1. **Plant foreshadowing element:**
   â€¢ Create "ç¥ç§˜å¾½ç« " foreshadowing in chapter 1
   â€¢ Set description: "ä¸»è§’å‘ç°ä¸€ä¸ªä¸æ˜æ¥æºçš„å¾½ç« "
   â€¢ Schedule payoff for chapter 5 with importance level 8

2. **Track foreshadowing status:** Monitor active foreshadowing elements
   â€¢ Return status: "ç¥ç§˜å¾½ç« " active for 4 chapters

3. **Resolve foreshadowing:** Complete the story arc in chapter 5
   â€¢ Add resolution note: "å¾½ç« åŸæ¥æ˜¯åæ´¾ç»„ç»‡çš„æ ‡å¿—"

4. **Generate integrity report:** Create comprehensive report showing all foreshadowing elements and their dependency relationships

---

## 6. æ•°æ®æµ

### 6.1 æ•°æ®æµå‘å›¾

```
è¾“å…¥å±‚                    å¤„ç†å±‚                    å­˜å‚¨å±‚                    è¾“å‡ºå±‚
   â”‚                        â”‚                        â”‚                        â”‚
ç”¨æˆ·å‘½ä»¤ â”€â”€â”€â”€â”€â”€â†’ Claudeä¸»çº¿ç¨‹ â”€â”€â”€â”€â”€â”€â†’ GitHub Issues â”€â”€â”€â”€â”€â”€â†’ è´¨é‡æŠ¥å‘Š
   â”‚                        â”‚                        â”‚                        â”‚
   â”‚                        â†“                        â†“                        â”‚
   â”‚              Context Firewall          æœ¬åœ°æ–‡ä»¶ç³»ç»Ÿ                      â”‚
   â”‚                        â”‚              (YAML/JSON/MD)                     â”‚
   â”‚                        â†“                        â†‘                        â”‚
   â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ SubAgentæ‰§è¡Œå±‚ â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                        â”‚
                     â”‚                                                        â”‚
                     â†“                                                        â†“
               8-Streamå¤„ç† â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â†’ æœ€ç»ˆæˆç¨¿
```

### 6.2 ä¸Šä¸‹æ–‡æµè½¬

**Context flow management:**
1. **Global context structure (cross-chapter):**
   â€¢ Bible: Complete world-building and setting information
   â€¢ Characters: Comprehensive character profiles and relationships
   â€¢ Plot progress: Overall story advancement tracking
   â€¢ Foreshadowings: Active plot elements awaiting resolution

2. **Chapter context structure (current chapter):**
   â€¢ Chapter number and specific outline details
   â€¢ Dependency requirements and previous chapter summary

3. **Stream context structure (independent processing):**
   â€¢ Stream identification and processing scope
   â€¢ Input from chapter context and output with summary/details separation

4. **Agent context structure (finest granularity):**
   â€¢ Specific agent task and style constraints from Bible
   â€¢ Access to previous work for consistency

### 6.3 æ•°æ®æŒä¹…åŒ–ç­–ç•¥

| æ•°æ®ç±»å‹ | å­˜å‚¨ä½ç½® | æ ¼å¼ | åŒæ­¥ç­–ç•¥ |
|---------|---------|------|---------|
| Bibleè®¾å®š | `data/bibles/` + Issue#1 | YAML | å…¨é‡åŒæ­¥ |
| ç« èŠ‚å†…å®¹ | `data/chapters/` + Issue#N | Markdown | å¢é‡åŒæ­¥ |
| Streamè¾“å‡º | `data/streams/` | Markdown | æœ¬åœ°ç¼“å­˜ |
| æ‰§è¡ŒçŠ¶æ€ | `data/status/` | JSON | å®æ—¶æ›´æ–° |
| ä¾èµ–å…³ç³» | `data/dependencies/` | JSON | å˜æ›´åŒæ­¥ |
| å·¥ä½œæµæ–‡æ¡£ | `data/workflow/` | JSON | ç‰ˆæœ¬æ§åˆ¶ |

---

## 7. å‘½ä»¤ç³»ç»Ÿ

### 7.1 æ ¸å¿ƒå‘½ä»¤åˆ—è¡¨

| å‘½ä»¤ | åŠŸèƒ½ | å‚æ•° | ç¤ºä¾‹ |
|-----|------|------|------|
| `/novel:init` | åˆå§‹åŒ–ç³»ç»Ÿ | æ—  | `/novel:init` |
| `/novel:project-new` | åˆ›å»ºæ–°é¡¹ç›® | é¡¹ç›®å | `/novel:project-new "é‡å­è§‰é†’"` |
| `/novel:concept-new` | åˆ›å»ºæ¦‚å¿µ | æ ‡é¢˜ | `/novel:concept-new "ç§‘å¹»æ‚¬ç–‘"` |
| `/novel:bible-create` | åˆ›å»ºBible | ç±»å‹ | `/novel:bible-create "éƒ½å¸‚å¼‚èƒ½"` |
| `/novel:chapter-decompose` | åˆ†è§£ç« èŠ‚ | Bible ID | `/novel:chapter-decompose bible_001` |
| `/novel:parallel-chapter` | å¹¶è¡Œç”Ÿæˆ | ç« èŠ‚å·åˆ—è¡¨ | `/novel:parallel-chapter 1 2 3` |
| `/novel:chapter-start` | ç”Ÿæˆå•ç«  | ç« èŠ‚å· | `/novel:chapter-start 1` |
| `/novel:quality-check` | è´¨é‡æ£€æŸ¥ | ç« èŠ‚å· | `/novel:quality-check 1` |
| `/novel:dependency-add` | æ·»åŠ ä¾èµ– | æº,ç›®æ ‡,ç±»å‹ | `/novel:dependency-add 1 5 foreshadowing` |
| `/novel:foreshadowing-add` | æ·»åŠ ä¼ç¬” | åç§°,ç« èŠ‚ | `/novel:foreshadowing-add "å¾½ç« " 1 5` |
| `/novel:github-init` | GitHubåˆå§‹åŒ– | é¡¹ç›®å | `/novel:github-init my-novel` |
| `/novel:sync` | åŒæ­¥åˆ°GitHub | ç« èŠ‚å· | `/novel:sync 1` |
| `/novel:status` | æŸ¥çœ‹çŠ¶æ€ | æ—  | `/novel:status` |
| `/novel:export` | å¯¼å‡ºä½œå“ | æ ¼å¼ | `/novel:export markdown` |
| `/novel:help` | è·å–å¸®åŠ© | å‘½ä»¤å | `/novel:help chapter-start` |

### 7.2 å‘½ä»¤å®šä¹‰æ ¼å¼

```markdown
---
allowed-tools: Task, Read, Write, Bash
---

# å‘½ä»¤åç§°

å‘½ä»¤æè¿°...

## Usage
`/novel:command-name <å‚æ•°>`

## Preflight Checklist
- [ ] æ£€æŸ¥å‰ç½®æ¡ä»¶
- [ ] éªŒè¯å‚æ•°
- [ ] åŠ è½½ä¾èµ–

## Instructions
1. æ­¥éª¤1
2. æ­¥éª¤2
3. æ­¥éª¤3

## Error Handling
- é”™è¯¯1: å¤„ç†æ–¹å¼
- é”™è¯¯2: å¤„ç†æ–¹å¼
```

---

## 8. Agentä½“ç³»

### 8.1 Agentåˆ†ç±»

#### 8.1.1 åŸºç¡€Stream Agent (8ä¸ª)

| Agent | èŒè´£ | è¾“å‡º |
|-------|------|------|
| `character-psychology-specialist` | è§’è‰²å¿ƒç†æ·±åº¦åˆ†æ | å¿ƒç†æ¨¡å‹ã€åŠ¨æœºé“¾ã€æƒ…æ„Ÿè½¨è¿¹ |
| `narrative-structure-specialist` | å™äº‹ç»“æ„ç®¡ç† | èŠ‚å¥æ§åˆ¶ã€å†²çªè®¾è®¡ã€è½¬æŠ˜ç‚¹ |
| `world-building-specialist` | ä¸–ç•Œæ„å»ºä¸æ„Ÿå®˜ | ç¯å¢ƒæå†™ã€æ°›å›´è¥é€ ã€æ„Ÿå®˜ç»†èŠ‚ |
| `prose-craft-specialist` | æ–‡ç¬”å·¥è‰ºä¼˜åŒ– | ä¿®è¾æŠ€å·§ã€è¯­è¨€èŠ‚å¥ã€é£æ ¼ç»Ÿä¸€ |
| `continuity-guard-specialist` | è¿è´¯æ€§å®ˆæŠ¤ | é€»è¾‘æ£€æŸ¥ã€æ—¶é—´çº¿ã€è®¾å®šä¸€è‡´ |
| `foreshadowing-specialist` | ä¼ç¬”ç®¡ç† | é“ºè®¾ã€ç»´æŠ¤ã€å›æ”¶è¿½è¸ª |
| `dialogue-master-specialist` | å¯¹è¯è‰ºæœ¯ | è§’è‰²è¯­è¨€ã€æ½œå°è¯ã€ä¿¡æ¯å¯†åº¦ |
| `emotion-weaver-specialist` | æƒ…æ„Ÿç¼–ç»‡ | æƒ…æ„Ÿæ›²çº¿ã€å…±é¸£ç‚¹ã€æ°›å›´æ¸²æŸ“ |

#### 8.1.2 åè°ƒAgent (2ä¸ª)

| Agent | èŒè´£ | æƒé™ |
|-------|------|------|
| `novel-parallel-coordinator` | å¹¶è¡Œæ‰§è¡Œåè°ƒ | å¯åŠ¨/åœæ­¢Streamã€å†²çªè§£å†³ |
| `director` | æ€»ä½“è§„åˆ’ | åˆ¶å®šè®¡åˆ’ã€åˆ†é…ä»»åŠ¡ã€è´¨é‡æŠŠå…³ |

#### 8.1.3 ç”ŸæˆAgent (8ä¸ª)

| Agent | èŒè´£ | ç‰¹é•¿ |
|-------|------|------|
| `outline-creator` | å¤§çº²ç”Ÿæˆ | ç»“æ„è®¾è®¡ã€èŠ‚å¥è§„åˆ’ |
| `scene-painter` | åœºæ™¯æå†™ | è§†è§‰å‘ˆç°ã€ç©ºé—´æ„Ÿ |
| `dialogue-specialist` | å¯¹è¯åˆ›ä½œ | å£è¯­åŒ–ã€ä¸ªæ€§åŒ– |
| `action-specialist` | åŠ¨ä½œæå†™ | åŠ¨ä½œè®¾è®¡ã€ç´§å¼ æ„Ÿ |
| `emotion-specialist` | æƒ…æ„Ÿæå†™ | å†…å¿ƒæ´»åŠ¨ã€æƒ…ç»ªå˜åŒ– |
| `description-specialist` | ç»†èŠ‚æå†™ | æ„Ÿå®˜ç»†èŠ‚ã€è±¡å¾éšå–» |
| `transition-specialist` | è¿‡æ¸¡å¤„ç† | åœºæ™¯åˆ‡æ¢ã€æ—¶é—´è·³è·ƒ |
| `climax-specialist` | é«˜æ½®è®¾è®¡ | å†²çªçˆ†å‘ã€æƒ…æ„Ÿé¡¶ç‚¹ |

#### 8.1.4 ä¼˜åŒ–Agent (5ä¸ª)

| Agent | èŒè´£ | ä¼˜åŒ–ç›®æ ‡ |
|-------|------|----------|
| `pacing-optimizer` | èŠ‚å¥ä¼˜åŒ– | å¼ å¼›æœ‰åº¦ã€é˜…è¯»ä½“éªŒ |
| `voice-tuner` | é£æ ¼è°ƒæ•´ | è¯­è¨€é£æ ¼ã€å™è¿°å£°éŸ³ |
| `suspense-engineer` | æ‚¬å¿µå·¥ç¨‹ | é’©å­è®¾ç½®ã€æœŸå¾…ç®¡ç† |
| `consistency-checker` | ä¸€è‡´æ€§æ£€æŸ¥ | è®¾å®šã€é€»è¾‘ã€é£æ ¼ |
| `quality-scorer` | è´¨é‡è¯„åˆ† | å¤šç»´åº¦è¯„ä¼°ã€æ”¹è¿›å»ºè®® |

#### 8.1.5 ç‰¹åŒ–Agent (åŠ¨æ€)

| ç« èŠ‚ç±»å‹ | é¢å¤–Agent | ä¸“é•¿ |
|---------|-----------|------|
| `action` | action-choreographer, pacing-specialist | åŠ¨ä½œè®¾è®¡ã€èŠ‚å¥æ§åˆ¶ |
| `romance` | emotion-weaver, intimacy-coordinator | æƒ…æ„Ÿç»†è…»ã€å…³ç³»å‘å±• |
| `mystery` | suspense-engineer, clue-tracker | æ‚¬å¿µè®¾ç½®ã€çº¿ç´¢ç®¡ç† |
| `dialogue` | conversation-architect, subtext-master | å¯¹è¯èŠ‚å¥ã€æ½œå°è¯ |
| `climax` | climax-orchestrator, tension-maximizer | é«˜æ½®è®¾è®¡ã€å¼ åŠ›æœ€å¤§åŒ– |

### 8.2 Agenté€šä¿¡åè®®

**Inter-agent communication protocol:**
1. **Message structure components:**
   â€¢ Source agent: character-psychology-specialist
   â€¢ Target agent: dialogue-master-specialist
   â€¢ Communication type: recommendation

2. **Content payload details:**
   â€¢ Character identification and speech pattern specifications
   â€¢ Current emotional state and suggested dialogue phrases

3. **Message metadata:**
   â€¢ Priority level: high
   â€¢ Timestamp: 2025-01-30T10:00:00Z

---

## 9. è´¨é‡æ§åˆ¶

### 9.1 è´¨é‡æ ‡å‡†ä½“ç³»

#### 9.1.1 8ç»´åº¦è¯„åˆ†æ ‡å‡†

| ç»´åº¦ | æƒé‡ | ç›®æ ‡åˆ† | è¯„ä¼°è¦ç‚¹ |
|-----|------|--------|---------|
| **è§’è‰²æ·±åº¦** | 15% | â‰¥95 | å¿ƒç†å¤æ‚åº¦ã€åŠ¨æœºåˆç†æ€§ã€æˆé•¿è½¨è¿¹ |
| **æƒ…èŠ‚è¿è´¯** | 15% | â‰¥99 | é€»è¾‘ä¸¥å¯†ã€å› æœå…³ç³»ã€èŠ‚å¥æ§åˆ¶ |
| **æ–‡å­—è¡¨è¾¾** | 15% | â‰¥95 | è¯­è¨€ä¼˜ç¾ã€ä¿®è¾æ°å½“ã€é£æ ¼ç»Ÿä¸€ |
| **è®¾å®šä¸€è‡´** | 10% | â‰¥98 | ä¸–ç•Œè§‚ç»Ÿä¸€ã€è§„åˆ™è‡ªæ´½ã€ç»†èŠ‚å‡†ç¡® |
| **æƒ…æ„Ÿå…±é¸£** | 15% | â‰¥95 | æƒ…æ„ŸçœŸå®ã€å…±é¸£ç‚¹ã€æ„ŸæŸ“åŠ› |
| **å¯¹è¯è‡ªç„¶** | 10% | â‰¥95 | å£è¯­åŒ–ã€ä¸ªæ€§åŒ–ã€ä¿¡æ¯å¯†åº¦ |
| **ä¼ç¬”å®Œæ•´** | 10% | 100 | é“ºè®¾åˆç†ã€å›æ”¶å®Œæ•´ã€æ„å¤–åˆç† |
| **åˆ›æ–°æ€§** | 10% | â‰¥90 | ç‹¬ç‰¹è§†è§’ã€æ–°é¢–è®¾å®šã€æ„å¤–è½¬æŠ˜ |

**ç»¼åˆè¯„åˆ†è®¡ç®—**ï¼š
**Overall quality score calculation:**
1. Multiply each dimension score by its corresponding weight
2. Sum all weighted dimension scores to get overall quality rating

### 9.2 5é˜¶æ®µè´¨é‡é—¨

**Five-stage quality gate system:**
1. **Stage 1 (10% completion) - Framework integrity:**
   â€¢ Minimum threshold: 80 points
   â€¢ Required checks: Outline exists, characters defined, world-building established

2. **Stage 2 (30% completion) - Basic content:**
   â€¢ Minimum threshold: 80 points
   â€¢ Required checks: Complete scenes, basic dialogue, action descriptions

3. **Stage 3 (60% completion) - Deep development:**
   â€¢ Minimum threshold: 85 points
   â€¢ Required checks: Character development, plot advancement, conflict expansion

4. **Stage 4 (80% completion) - Chapter coherence:**
   â€¢ Minimum threshold: 90 points
   â€¢ Required checks: Narrative consistency, foreshadowing management, pacing flow

5. **Stage 5 (100% completion) - Final polish:**
   â€¢ Minimum threshold: 95 points
   â€¢ Required checks: Language refinement, detail enhancement, emotional elevation

### 9.3 ä¸‰è½®è¿­ä»£ç³»ç»Ÿ

**Iterative optimizer specialist:**
1. **Round 1 optimization (target 85 points):** Apply if current score below 85
   â€¢ Fix logical errors and inconsistencies
   â€¢ Add missing content elements
   â€¢ Adjust basic pacing issues

2. **Round 2 optimization (target 92 points):** Apply if current score below 92
   â€¢ Deepen character psychological development
   â€¢ Strengthen conflict tension and stakes
   â€¢ Optimize language expression and clarity

3. **Round 3 optimization (target 98 points):** Apply if current score below 98
   â€¢ Refine intricate details and nuances
   â€¢ Enhance literary quality and style
   â€¢ Amplify emotional impact and resonance

4. Return optimized content after applicable rounds

### 9.4 è´¨é‡ç›‘æ§ä»ªè¡¨æ¿

```
â•”â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•—
â•‘              NOVELSYS è´¨é‡ç›‘æ§ä»ªè¡¨æ¿                         â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ç« èŠ‚: ç¬¬1ç«                      çŠ¶æ€: ç”Ÿæˆä¸­                  â•‘
â•‘ ç›®æ ‡è´¨é‡: 98åˆ†                  å½“å‰: 92.5åˆ†                  â•‘
â• â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•£
â•‘ ç»´åº¦è¯„åˆ†:                                                    â•‘
â•‘ â”Œâ”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”¬â”€â”€â”€â”€â”€â”€â”€â”€â”€â”                â•‘
â•‘ â”‚ è§’è‰²æ·±åº¦     â”‚ 95/95 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ âœ…      â”‚                â•‘
â•‘ â”‚ æƒ…èŠ‚è¿è´¯     â”‚ 98/99 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–Œ â”‚ âš ï¸      â”‚                â•‘
â•‘ â”‚ æ–‡å­—è¡¨è¾¾     â”‚ 90/95 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–Œ  â”‚ âš ï¸      â”‚                â•‘
â•‘ â”‚ è®¾å®šä¸€è‡´     â”‚ 98/98 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ âœ…      â”‚                â•‘
â•‘ â”‚ æƒ…æ„Ÿå…±é¸£     â”‚ 89/95 â”‚ â–ˆâ–ˆâ–ˆâ–ˆ   â”‚ âš ï¸      â”‚                â•‘
â•‘ â”‚ å¯¹è¯è‡ªç„¶     â”‚ 95/95 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ âœ…      â”‚                â•‘
â•‘ â”‚ ä¼ç¬”å®Œæ•´     â”‚100/100â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆâ–ˆ â”‚ âœ…      â”‚                â•‘
â•‘ â”‚ åˆ›æ–°æ€§      â”‚ 88/90 â”‚ â–ˆâ–ˆâ–ˆâ–ˆâ–ˆ  â”‚ âš ï¸      â”‚                â•‘
â•‘ â””â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”´â”€â”€â”€â”€â”€â”€â”€â”€â”€â”˜                â•‘
â•‘ æ”¹è¿›å»ºè®®:                                                    â•‘
â•‘ â€¢ åŠ å¼ºç¬¬3æ®µçš„æƒ…æ„Ÿæå†™                                        â•‘
â•‘ â€¢ ä¼˜åŒ–ç¬¬2ä¸ªåœºæ™¯çš„è¿‡æ¸¡                                        â•‘
â•‘ â€¢ æå‡å¯¹è¯çš„ä¸ªæ€§åŒ–                                          â•‘
â•šâ•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•â•
```

---

## 10. æ€§èƒ½ä¼˜åŒ–

### 10.1 æ€§èƒ½æŒ‡æ ‡

| æŒ‡æ ‡ | ç›®æ ‡å€¼ | å®æµ‹å€¼ | ä¼˜åŒ–ç­–ç•¥ |
|-----|--------|--------|---------|
| **ç« èŠ‚ç”Ÿæˆæ—¶é—´** | <5åˆ†é’Ÿ | 3åˆ†é’Ÿ | å¹¶è¡ŒStreamæ‰§è¡Œ |
| **Tokenä½¿ç”¨** | <50K/ç«  | 35K/ç«  | Context Firewall |
| **å†…å­˜å ç”¨** | <500MB | 320MB | æµå¼å¤„ç† |
| **åŒæ­¥å¸¦å®½** | <100KB/æ¬¡ | 10KB/æ¬¡ | å¢é‡åŒæ­¥ |
| **å¹¶å‘Agent** | 8-15ä¸ª | 12ä¸ª | åŠ¨æ€åˆ†é… |

### 10.2 ä¼˜åŒ–æŠ€æœ¯

#### 10.2.1 Context Firewallä¼˜åŒ–
**Context firewall token optimization:**
1. **Optimized approach:** Main thread receives 50 characters per agent summary
2. **Traditional approach:** Each agent would send 2000 characters to main thread
3. **Token savings calculation:** 97.5% reduction in main thread token usage

#### 10.2.2 å¢é‡åŒæ­¥ä¼˜åŒ–
**Incremental sync optimization strategy:**
1. **Patch mode:** For changes under 10 lines - minimal data transfer
2. **Incremental mode:** For changes 10-100 lines - moderate data transfer
3. **Full mode:** For changes over 100 lines - complete content transfer

#### 10.2.3 å¹¶è¡Œæ‰§è¡Œä¼˜åŒ–
**Parallel execution optimization:**
1. **Identify parallelizable tasks:** Analyze chapter to find independent streams
2. **Batch execute tasks:** Run all parallel tasks simultaneously using async gathering
3. **Time savings:** 60-70% reduction compared to sequential execution

#### 10.2.4 ç¼“å­˜ç­–ç•¥
**Multi-layer caching strategy:**
â€¢ **L1 Memory cache:** Store frequently accessed hot data in system memory
â€¢ **L2 File cache:** Cache commonly used data in local file system
â€¢ **L3 GitHub Issues:** Maintain persistent data in GitHub Issues for long-term storage

### 10.3 æ‰©å±•æ€§è®¾è®¡

```yaml
æ°´å¹³æ‰©å±•:
  - Agentæ•°é‡: 8 â†’ 15 â†’ 30 (æ ¹æ®éœ€è¦)
  - ç« èŠ‚å¹¶è¡Œ: 1 â†’ 3 â†’ 10 (Git Worktree)
  - é¡¹ç›®å¹¶å‘: æ”¯æŒå¤šé¡¹ç›®åŒæ—¶è¿›è¡Œ

å‚ç›´ä¼˜åŒ–:
  - è´¨é‡æå‡: 85 â†’ 92 â†’ 98åˆ†
  - æ·±åº¦å¢å¼º: æ›´å¤æ‚çš„ä¾èµ–å…³ç³»
  - æ™ºèƒ½å‡çº§: æ›´æ™ºèƒ½çš„Agentåˆ†é…
```

---

## 11. éƒ¨ç½²æŒ‡å—

### 11.1 ç¯å¢ƒå‡†å¤‡

```bash
# 1. å®‰è£…GitHub CLI
gh auth login

# 2. é…ç½®Git
git config --global user.name "Your Name"
git config --global user.email "your@email.com"

# 3. å…‹éš†é¡¹ç›®
git clone https://github.com/yourusername/NOVELSYS-SWARM.git
cd NOVELSYS-SWARM

# 4. å®‰è£…ä¾èµ–
pip install -r requirements.txt
```

### 11.2 åˆå§‹åŒ–ç³»ç»Ÿ

```bash
# 1. åœ¨Claude Codeä¸­æ‰“å¼€é¡¹ç›®
claude-code NOVELSYS-SWARM/

# 2. åˆå§‹åŒ–ç³»ç»Ÿ
/novel:init

# 3. åˆ›å»ºGitHubé¡¹ç›®ï¼ˆå¯é€‰ï¼‰
/novel:github-init my-novel-project

# 4. éªŒè¯å®‰è£…
/novel:status
```

### 11.3 é…ç½®æ–‡ä»¶

```json
// .claude/settings.local.json
{
  "github": {
    "owner": "your-username",
    "repo": "your-novel-repo",
    "token": "ghp_xxxxxxxxxxxx"  // å¯é€‰
  },
  "quality": {
    "target_score": 98,
    "max_iterations": 3,
    "parallel_agents": 12
  },
  "sync": {
    "auto_sync": true,
    "sync_interval": 300,  // ç§’
    "incremental": true
  }
}
```

### 11.4 æ•…éšœæ’é™¤

| é—®é¢˜ | åŸå›  | è§£å†³æ–¹æ¡ˆ |
|-----|------|---------|
| Agentæ‰§è¡Œå¤±è´¥ | å†…å­˜ä¸è¶³ | å‡å°‘å¹¶è¡ŒAgentæ•°é‡ |
| GitHubåŒæ­¥å¤±è´¥ | è®¤è¯é—®é¢˜ | è¿è¡Œ `gh auth login` |
| è´¨é‡åˆ†æ•°ä½ | è¿­ä»£ä¸è¶³ | å¢åŠ max_iterations |
| ç”Ÿæˆé€Ÿåº¦æ…¢ | é¡ºåºæ‰§è¡Œ | å¯ç”¨parallelæ¨¡å¼ |
| ä¾èµ–å†²çª | å¾ªç¯ä¾èµ– | æ£€æŸ¥dependencyå›¾ |

---

## 12. APIå‚è€ƒ

### 12.1 æ ¸å¿ƒç±»

**Core system classes:**

**Context Firewall specialist:**
â€¢ **Filter agent response:** Extract summary from AgentResponse and return filtered string
â€¢ **Batch filter responses:** Process multiple AgentResponse objects and return combined summary

**GitHub Integration specialist:**
â€¢ **Create novel repository:** Generate new GitHub repo for project, return success status and repo URL
â€¢ **Sync chapter to issue:** Update specific GitHub issue with chapter data, return sync success status

**Novel Parallel Coordinator specialist:**
â€¢ **Execute chapter processing:** Coordinate multi-stream chapter generation, return processed chapter data
â€¢ **Generate status report:** Create comprehensive execution status summary

**Dependency Manager specialist:**
â€¢ **Add chapter dependency:** Create dependency relationship between chapters, return dependency ID
â€¢ **Validate chapter readiness:** Check if chapter dependencies are satisfied, return status and unmet list

**Five Stage Workflow specialist:**
â€¢ **Create concept:** Generate initial story concept from title and genre, return concept ID
â€¢ **Create Bible document:** Build comprehensive Bible from concept, return Bible ID
â€¢ **Generate traceability report:** Create complete workflow tracking report

### 12.2 æ•°æ®ç»“æ„

**Core data structures:**

**AgentResponse structure:**
â€¢ Summary: Main thread summary text
â€¢ Status: Current execution state
â€¢ Decisions: List of key strategic decisions made
â€¢ Next steps: List of recommended follow-up actions
â€¢ Metrics: Quality indicators and performance data
â€¢ Details: Complete content (internal only, not returned to main thread)

**Dependency structure:**
â€¢ ID: Unique dependency identifier
â€¢ Type: Category of dependency relationship
â€¢ Source and target: Connected elements
â€¢ Description: Detailed dependency explanation
â€¢ Strength: Importance level (numeric)
â€¢ Hard dependency flag and resolution status

**ChapterExecution structure:**
â€¢ Chapter number and title
â€¢ Agent counts: Total assigned and completed
â€¢ Overall progress percentage
â€¢ Quality score (optional, when available)

### 12.3 äº‹ä»¶é’©å­

**Event hook system:**

**Available event hooks:**
â€¢ **before_chapter_start:** Triggered before chapter generation begins
â€¢ **after_stream_complete:** Triggered when individual stream processing finishes
â€¢ **on_quality_check:** Triggered during quality assessment phase
â€¢ **before_sync:** Triggered before synchronization to external systems
â€¢ **after_sync:** Triggered after successful synchronization
â€¢ **on_conflict:** Triggered when conflicts between streams are detected
â€¢ **on_error:** Triggered when errors occur during processing

**Hook registration process:**
1. Accept event name and callback function as parameters
2. Add callback to the specified event's callback list
3. Enable custom logic execution at specific system events

---

## é™„å½•A: å‘½ä»¤é€ŸæŸ¥è¡¨

```bash
# é¡¹ç›®ç®¡ç†
/novel:init                        # åˆå§‹åŒ–
/novel:project-new "åç§°"          # æ–°é¡¹ç›®
/novel:project-list                # é¡¹ç›®åˆ—è¡¨
/novel:status                      # å½“å‰çŠ¶æ€

# åˆ›ä½œæµç¨‹
/novel:concept-new "æ ‡é¢˜"          # åˆ›å»ºæ¦‚å¿µ
/novel:bible-create "ç±»å‹"         # åˆ›å»ºBible
/novel:chapter-decompose           # ç« èŠ‚åˆ†è§£
/novel:chapter-start 1             # ç”Ÿæˆç« èŠ‚
/novel:parallel-chapter 1 2 3      # å¹¶è¡Œç”Ÿæˆ

# è´¨é‡ç®¡ç†
/novel:quality-check 1             # è´¨é‡æ£€æŸ¥
/novel:iterate 1                   # è¿­ä»£ä¼˜åŒ–

# ä¾èµ–ç®¡ç†
/novel:dependency-add 1 5 "plot"   # æ·»åŠ ä¾èµ–
/novel:foreshadowing-add "å" 1 5  # æ·»åŠ ä¼ç¬”
/novel:dependency-check 3          # æ£€æŸ¥ä¾èµ–

# åŒæ­¥ç®¡ç†
/novel:github-init "é¡¹ç›®å"        # GitHubåˆå§‹åŒ–
/novel:sync 1                      # åŒæ­¥ç« èŠ‚
/novel:sync-all                    # å…¨éƒ¨åŒæ­¥

# å¯¼å‡º
/novel:export markdown             # å¯¼å‡ºMarkdown
/novel:export epub                 # å¯¼å‡ºEPUB
```

## é™„å½•B: è´¨é‡æ£€æŸ¥æ¸…å•

```markdown
## ç« èŠ‚è´¨é‡æ£€æŸ¥æ¸…å•

### ç»“æ„å®Œæ•´æ€§
- [ ] å¼€å¤´å¸å¼•äºº
- [ ] ä¸­é—´æœ‰èµ·ä¼
- [ ] ç»“å°¾æœ‰æ‚¬å¿µ
- [ ] åœºæ™¯è½¬æ¢æµç•…

### è§’è‰²è¡¨ç°
- [ ] è§’è‰²è¡Œä¸ºç¬¦åˆè®¾å®š
- [ ] å¯¹è¯ç¬¦åˆèº«ä»½
- [ ] æƒ…æ„Ÿå˜åŒ–åˆç†
- [ ] æˆé•¿è½¨è¿¹æ¸…æ™°

### æƒ…èŠ‚é€»è¾‘
- [ ] å› æœå…³ç³»åˆç†
- [ ] æ—¶é—´çº¿æ­£ç¡®
- [ ] æ²¡æœ‰é€»è¾‘æ¼æ´
- [ ] å†²çªæœ‰å¼ åŠ›

### æ–‡å­—è¡¨è¾¾
- [ ] è¯­è¨€æµç•…
- [ ] æå†™ç”ŸåŠ¨
- [ ] èŠ‚å¥æ°å½“
- [ ] é£æ ¼ç»Ÿä¸€

### ä¸–ç•Œè§‚ä¸€è‡´
- [ ] è®¾å®šæ²¡æœ‰çŸ›ç›¾
- [ ] è§„åˆ™è‡ªæ´½
- [ ] ç»†èŠ‚å‡†ç¡®
- [ ] æ°›å›´ç»Ÿä¸€

### ä¼ç¬”å¤„ç†
- [ ] æ–°ä¼ç¬”åˆç†é“ºè®¾
- [ ] æ—§ä¼ç¬”é€‚æ—¶æ¨è¿›
- [ ] è¯¥å›æ”¶çš„å·²å›æ”¶
- [ ] æ²¡æœ‰é—æ¼çš„çº¿ç´¢
```

## é™„å½•C: æ•…éšœè¯Šæ–­æµç¨‹

```mermaid
graph TD
    A[é—®é¢˜å‘ç”Ÿ] --> B{ä»€ä¹ˆç±»å‹?}
    B -->|ç”Ÿæˆå¤±è´¥| C[æ£€æŸ¥Bibleå®Œæ•´æ€§]
    B -->|è´¨é‡å¤ªä½| D[å¢åŠ è¿­ä»£æ¬¡æ•°]
    B -->|é€Ÿåº¦å¤ªæ…¢| E[æ£€æŸ¥å¹¶è¡Œè®¾ç½®]
    B -->|åŒæ­¥å¤±è´¥| F[éªŒè¯GitHubè®¤è¯]
    
    C --> G[ä¿®å¤Bible]
    D --> H[è°ƒæ•´è´¨é‡å‚æ•°]
    E --> I[ä¼˜åŒ–Agentæ•°é‡]
    F --> J[é‡æ–°è®¤è¯]
    
    G --> K[é‡è¯•ç”Ÿæˆ]
    H --> K
    I --> K
    J --> K
    
    K --> L{æˆåŠŸ?}
    L -->|æ˜¯| M[é—®é¢˜è§£å†³]
    L -->|å¦| N[æŸ¥çœ‹æ—¥å¿—]
    N --> O[è”ç³»æ”¯æŒ]
```

---

## ç‰ˆæœ¬å†å²

| ç‰ˆæœ¬ | æ—¥æœŸ | æ›´æ–°å†…å®¹ |
|-----|------|---------|
| 2.5.0 | 2025-01-30 | å®Œæ•´å®ç°CCPMç‰¹æ€§é›†æˆ |
| 2.0.0 | 2025-01-29 | 8-Streamæ¶æ„å®ç° |
| 1.0.0 | 2025-01-28 | åˆå§‹ç‰ˆæœ¬å‘å¸ƒ |

---

## è®¸å¯è¯

MIT License

---

*æœ¬æ–‡æ¡£ä¸ºNOVELSYS-SWARM 2.5çš„å®Œæ•´æŠ€æœ¯æ–‡æ¡£ï¼ŒåŒ…å«æ‰€æœ‰å·²å®ç°åŠŸèƒ½çš„è¯¦ç»†è¯´æ˜ã€‚*

**æ–‡æ¡£å®Œæˆåº¦**: 100%  
**æŠ€æœ¯å®ç°åº¦**: 100%  
**æµ‹è¯•è¦†ç›–ç‡**: 60%  

---

æœ€åæ›´æ–°: 2025-01-30 15:00:00 UTC+8